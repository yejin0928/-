CREATE OR REPLACE PROCEDURE insert_food
/* IN Parameter */
( REFRIGERATOR_FOODNAME  IN CHAR,
REFRIGERATOR_FOODPURCHASEDATE IN DATE,
REFRIGERATOR_FOODBESTBEFORE IN DATE,
USER_ID IN VARCHAR2,
RESULT OUT VARCHAR2
)
IS
average_best NUMBER;
plus DATE;
auto_input DATE;

BEGIN



IF REFRIGERATOR_FOODBESTBEFORE='1999-12-12' THEN
    SELECT AVERAGE_BESTBEFORE INTO average_best 
    FROM FOOD WHERE FOOD_NAME=REFRIGERATOR_FOODNAME;

    SELECT TO_CHAR(REFRIGERATOR_FOODPURCHASEDATE+average_best,'yyyy-mm-dd') INTO plus FROM DUAL;
    INSERT INTO REFRIGERATOR VALUES(REFRIGERATOR_FOODNAME,REFRIGERATOR_FOODPURCHASEDATE,plus,USER_ID);
    RESULT :='유통기한이 자동으로 입력되었습니다.';   
ELSE
    INSERT INTO REFRIGERATOR VALUES(REFRIGERATOR_FOODNAME,REFRIGERATOR_FOODPURCHASEDATE,REFRIGERATOR_FOODBESTBEFORE,USER_ID);
    RESULT :='등록되었습니다.';
END IF;

COMMIT;
END;
/ 